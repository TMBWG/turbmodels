&version_number
    input_version = 2.2
/
&project
    project_rootname = 'Case4'
    case_title = 'SS_Axi_Noz_Case4'
/

!!------------------------------------------------------------------------------
!! Notes
!!
!! + The FUN3D simulation used a grid composed of a 180 degree sector of the
!!   nozzle and surrounding flowfield.
!! + The FUN3D simulation was performed in two steps:
!!   1) Global CFL using, Outflow 5061 and flow initialization.
!!   2) Global timestep, using Outflow 5051.
!!   These steps will be denoted as "Step 1" and "Step 2" in the namelists below.
!!
!!------------------------------------------------------------------------------

&raw_grid
    grid_format = 'aflr3'
    data_format = 'stream'
/
&governing_equations
    eqn_type = 'cal_perf_compress'
    viscous_terms = 'turbulent'
/
&reference_physical_properties
    dim_input_type = 'nondimensional'
    temperature_units = 'Rankine'
    temperature = 520.0
    angle_of_attack = 1.0
    angle_of_yaw = 0.0
    reynolds_number = 5968
    mach_number = 0.01
/
&force_moment_integ_properties
    area_reference  = 1.0
    x_moment_length = 1.0
    y_moment_length = 1.0
    x_moment_center = 0.0
    y_moment_center = 0.0
    z_moment_center = 0.0
/
&inviscid_flux_method
!!--Step 1------------------------------
    flux_limiter = 'hvanleer'
    flux_construction = 'roe'
    freeze_limiter_iteration = 4000
!!--Step 2------------------------------
!    flux_limiter = 'hvanleer'
!    flux_construction = 'roe'
!    freeze_limiter_iteration = 10000
/
&flow_initialization
!!--Step 1------------------------------
    number_of_volumes = 1
    type_of_volume(1) = 'cylinder'
    point1(1:3,1) = -18.0  0.0 0.0
    point2(1:3,1) = -4.0 0.0 0.0
    radius(1) = 3.0
    rho(1) = 1.216  !--NPR/NTR
    c(1) = 1.103  !--sqrt(NPR/NTR)
!!--------------------------------------
/
&turbulent_diffusion_models
    turbulence_model = 'sst-v'
    prandtlnumber_turbulent  = 0.9
/
&nonlinear_solver_parameters
!!--Step 1------------------------------
    time_accuracy =      'steady'
    schedule_iteration = 1 5000
    schedule_cfl =       0.5 20.0
    schedule_cflturb =   0.5 10.0
!!--Step 2------------------------------
!    time_accuracy        = '2ndorderOPT'
!    time_step_nondim     = 13.5124
!    subiterations        = 20
!    temporal_err_control = .true.
!    temporal_err_floor   = 0.1
!    schedule_iteration(1:2)   = 1 20  !--added
!    schedule_cfl(1:2)         = 10.0  20.0
!    schedule_cflturb(1:2)     = 5.0  5.0
!    f_allow_minimum_m    = 0.01   !--added
!!--------------------------------------
/
&code_run_control
!!--Step 1------------------------------
    steps = 6000
    restart_read = 'off'
    stopping_tolerance = 1.0E-12
    restart_write_freq = 1000
!!--Step 2------------------------------
!    steps = 20000
!!    restart_read = 'on'  !--uncomment if restarting time-accurate simulation
!    restart_read = 'on_nohistorykept'  !--comment if restarting time-accurate simulation
!    stopping_tolerance = 1.0E-12
!    restart_write_freq = 1000
!!--------------------------------------
/
&boundary_conditions
    grid_units = 'inches'

    total_pressure_ratio(3) = 3.010                    ! Nozzle Inflow
    total_temperature_ratio(3) = 2.476                 ! Nozzle Inflow

    static_pressure_ratio(4) = 1.000                   ! Outflow

!!-----Set Adiabatic Wall Temp-----
    wall_temp_flag(6)              = .true.
    wall_temperature(6)            = -1
    wall_temp_flag(7)              = .true.
    wall_temperature(7)            = -1
    wall_temp_flag(8)              = .true.
    wall_temperature(8)            = -1
/
&sampling_parameters
  number_of_geometries        = 10
!!-----z=0 Plane-----
    label(1) = 'Plane_z_0'
      type_of_geometry(1)       = 'plane'
      plane_center(:,1)       = 0.0, 0.0, 0.0
      plane_normal(:,1)       = 0.0, 0.0, 1.0
      sampling_frequency(1)   = 1000
!      sampling_frequency(1)   = -1
!!-----Centerline-----
    label(2) = 'Centerline'
      type_of_geometry(2)       = 'line'
      p1_line(:,2)            = -18.0, 0.001, 0.0
      p2_line(:,2)            = 80.0, 0.001, 0.0
      sampling_frequency(2)   = 1000
!      sampling_frequency(2)   = -1
!!-----Lipline: r/D=1-----
    label(3) = 'Lipline'
      type_of_geometry(3)       = 'line'
      p1_line(:,3)            = 0.0, 1.0, 0.0
      p2_line(:,3)            = 80.0, 1.0, 0.0
      sampling_frequency(3)   = 1000
!      sampling_frequency(3)   = -1
!!-----Radial Profile: x/D=0
    label(4) = 'xD_0'
      type_of_geometry(4)       = 'line'
      p1_line(:,4)            = 0.0, 0.0, 0.0
      p2_line(:,4)            = 0.0, 1.0, 0.0
      sampling_frequency(4)   = 1000
!      sampling_frequency(4)   = -1
!!-----Radial Profile: x/D=2
    label(5) = 'xD_2'
      type_of_geometry(5)       = 'line'
      p1_line(:,5)            = 4.0, 0.0, 0.0
      p2_line(:,5)            = 4.0, 6.0, 0.0
      sampling_frequency(5)   = 1000
!      sampling_frequency(5)   = -1
!!-----Radial Profile: x/D=4
    label(6) = 'xD_4'
      type_of_geometry(6)       = 'line'
      p1_line(:,6)            = 8.0, 0.0, 0.0
      p2_line(:,6)            = 8.0, 6.0, 0.0
      sampling_frequency(6)   = 1000
!      sampling_frequency(6)   = -1
!!-----Radial Profile: x/D=8
    label(7) = 'xD_8'
      type_of_geometry(7)       = 'line'
      p1_line(:,7)            = 16.0, 0.0, 0.0
      p2_line(:,7)            = 16.0, 6.0, 0.0
      sampling_frequency(7)   = 1000
!      sampling_frequency(7)   = -1
!!-----Radial Profile: x/D=12
    label(8) = 'xD_12'
      type_of_geometry(8)       = 'line'
      p1_line(:,8)            = 24.0, 0.0, 0.0
      p2_line(:,8)            = 24.0, 6.0, 0.0
      sampling_frequency(8)   = 1000
!      sampling_frequency(8)   = -1
!!-----Radial Profile: x/D=16
    label(9) = 'xD_16'
      type_of_geometry(9)       = 'line'
      p1_line(:,9)            = 32.0, 0.0, 0.0
      p2_line(:,9)            = 32.0, 6.0, 0.0
      sampling_frequency(9)   = 1000
!      sampling_frequency(9)   = -1
!!-----Nozzle Outflow-----
    label(10) = 'NozzleOutflow'
      type_of_geometry(10)      = 'circle'
      circle_center(:,10)     = 0.0, 0.0, 0.0
      circle_normal(:,10)     = 1.0, 0.0, 0.0
      circle_radius(10)       = 6.0
      sampling_frequency(10)  = 1000
!      sampling_frequency(10)  = -1
/
&component_parameters
    number_of_components      = 3

    component_name(1)         = 'Nozzle'
	component_type(1)         = 'boundary'
    component_count(1)        = 2
    component_input(1)        = '3,7'
    component_symmetry(1)     = 2
    calculate_cd(1)           = .true.
    throat_area(1)            = 2.419
    npr(1)                    = 3.010
    ntr(1)                    = 2.476
    calculate_thrust_ratio(1) = .true.
    massflow_component(1)     = 3

    component_name(2)         = 'Nozzle_Inflow'
 	component_type(2)         = 'boundary'
    component_count(2)        = 1
    component_input(2)        = '3'
    component_symmetry(2)     = 2

	component_name(3)         = 'Nozzle_Outflow'
	component_type(3)         = 'circle'
	component_count(3)        = 1
    component_symmetry(3)     = 2
	circle_center(:,3)        = 0.001, 0.0, 0.0
	circle_normal(:,3)        = 1.0, 0.0, 0.0
	circle_radius(3)          = 1.0

    allow_flow_through_forces = .true.
    list_forces               = .true.
    area_reference_ct         = 3.1416
/
&global
!    boundary_animation_freq = -1
    boundary_animation_freq = 1000
!    volume_animation_freq   = 1000
    volume_animation_freq   = 10000
/
&time_avg_params
    itime_avg = 0
    use_prior_time_avg = 1
!!--This option controls the variables for which statistics are collected.
!!  `1' for primitive variable averages and root mean squares.
!!  `2' for primitive variable averages, primitive variable root mean squares, and the averages of u'v',u'w',v'w',mu_t,vort_mag.
    tavg_header_version = 2
/
&sampling_output_variables
    x                         = .true.
    y                         = .true.
    z                         = .true.
!!--primitive variables: rho,u,v,w,p
    primitive_variables       = .true.
    temperature               = .true.
    mach                      = .true.
    ttot                      = .true.
    ptot                      = .true.
    cp                        = .true.
    yplus                     = .true.
    turb1                     = .true.
    mu_t_ratio                = .true.
    mu_t                      = .true.
    dudy                      = .true.
    dvdx                      = .true.
/
&boundary_output_variables
    number_of_boundaries      = -1       ! compute from list
    boundary_list             = '1-8'
    x                         = .true.
    y                         = .true.
    z                         = .true.
!!--primitive variables: rho,u,v,w,p
    primitive_variables       = .true.
    temperature               = .true.
    mach                      = .true.
    ttot                      = .true.
    ptot                      = .true.
    cp                        = .true.
    yplus                     = .true.
    turb1                     = .true.
    cf_x                      = .true.
    cf_y                      = .true.
    cf_z                      = .true.
/
&volume_output_variables
    export_to                 = 'tecplot'
    x                         = .true.
    y                         = .true.
    z                         = .true.
!!--primitive variables: rho,u,v,w,p
    primitive_variables       = .true.
    temperature               = .true.
    mach                      = .true.
    turb1                     = .true.
    residuals                 = .true.
/


