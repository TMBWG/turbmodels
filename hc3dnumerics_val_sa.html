<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xml:lang="en" lang="en">
<HEAD>
<TITLE>3D Hemisphere Cylinder Validation for Turbulence Model Numerical Analysis - SA-neg Model Results</TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<script language="JavaScript">
<!--
function MM_preloadImages() { //v3.0
  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length; i++)
    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
}

function MM_swapImgRestore() { //v3.0
  var i,x,a=document.MM_sr; for(i=0;a&&i<a.length&&(x=a[i])&&x.oSrc;i++) x.src=x.oSrc;
}

function MM_swapImage() { //v3.0
  var i,j=0,x,a=MM_swapImage.arguments; document.MM_sr=new Array; for(i=0;i<(a.length-2);i+=3)
   if ((x=MM_findObj(a[i]))!=null){document.MM_sr[j++]=x; if(!x.oSrc) x.oSrc=x.src; x.src=a[i+2];}
}

function MM_findObj(n, d) { //v4.01
  var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
  if(!x && d.getElementById) x=d.getElementById(n); return x;
}
//-->
</script>
<script async type="text/javascript" src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=NASA&amp;subagency=LARC" id="_fed_an_ua_tag"></script>
</HEAD>
<body text="#000000" bgcolor="#FFFFFF" link="#0000EE" vlink="#551A8B"
alink="#FF0000">
<p><a href="#main-content"><img src="spacer.gif" width="0" height="0" border="0" alt="skip to content" /></a></p>
<style>
    * {
      font-family: helvetica,arial,sans-serif;
    }
</style>
<a id="main-content"></a>
<p>
   <center>
     <table width="775" border="0">
       <tr>

      <td width="144"><a href="http://www.nasa.gov/"><img border=0 src="colormeatball.jpg" width="144"
height="119" title="NASA Logo" alt="NASA Logo"></td>
         <td>
         <p><h2 style="text-align: left"><strong>
              Langley Research Center</strong></h2></p>
         <p><h1 style="text-align: left"><strong>
              Turbulence Modeling Resource</strong></h1></p>
         </td>
       </tr>
     </table>

<!--<img border=0 src="construction.gif" title="under construction" alt="under construction">
This page under construction... Come back later!-->
<br>&nbsp;

   </center>

<br>&nbsp;
<p><span style="text-align: left; font-weight: 400; font-size: medium">
<!--Jump to: <a href="flatplate_val_sst.html">SST Results</a>,&nbsp;
         <a href="flatplate_val_sstv.html">SST-V Results</a>,&nbsp;
         <a href="flatplate_val_w06.html">Wilcox2006 Results</a>,&nbsp;
         <a href="flatplate_val_easmkos.html">EASMko2003-S Results</a>,&nbsp;
         <a href="flatplate_val_kert.html">K-e-Rt Results</a>,&nbsp;
         <a href="flatplate_val_kkl-meah.html">K-kL-MEAH2013 Results</a></p>-->
<p>Return to: <a href="hc3dnumerics_val.html">3D Hemisphere Cylinder Validation for Numerical Analysis Intro Page</a></p>
<p>Return to: <a href="index.html">Turbulence Modeling Resource Home Page</a></p>
<br>&nbsp;
<p><strong><span style="text-align: left; font-weight: 700; font-size: x-large">TURBULENCE MODEL NUMERICAL ANALYSIS</strong>
<p><strong><span style="text-align: left; font-weight: 700; font-size: x-large">3D Hemisphere Cylinder Validation</strong>
<p><strong><span style="text-align: left; font-weight: 700; font-size: x-large"><span style="color: blue">SA-neg Model Results</span></strong>

<br>&nbsp;
<p><span style="text-align: left; font-weight: 700; font-size: large">
<a href="spalart.html#saneg">Link to SA-neg equations</a>

<p><span style="text-align: left; font-weight: 400; font-size: medium">
Results are shown for the 3D hemisphere cylinder at M=0.6, Re=0.35 million based on unit length, reference temperature
of 540 R, and angle of attack of zero.
Three different CFD codes (FUN3D, USM3D, and CFL3D) have been employed
in an effort to try to discern the grid-converged result for this case. 
Results here
are for the <a href="spalart.html#saneg">SA-neg</a> variant of the SA model.
However, SA-neg is passive to the
original (SA) model in well-resolved flowfields, and hence is expected to yield essentially identical
results as SA for the cases here.
FUN3D and USM3D both used clipping method "a" with cutoff 0.00001 for <img class="tex" alt="\hat S" src="spalart_eqns/img30.png" />,
while CFL3D used clipping method "c" (see <u>Note 1</u> on
<a href="spalart.html">the Spalart-Allmaras equation page</a>).
For all codes, the farfield value of the Spalart turbulence variable is
<img class="tex" alt="\tilde \nu_{farfield} \geq 3 \nu_{\infty}"
  src="spalart_eqns/img12.png" />.
In all codes the Prandtl number Pr is taken to be constant at 0.72, and turbulent Prandtl
number Pr<sub>t</sub> is taken to be constant at 0.9.
The dynamic viscosity is computed using
Sutherland's Law (See White, F. M., "Viscous Fluid Flow," McGraw Hill, New York, 1974, p. 28).
In Sutherland's Law, the local value of dynamic viscosity is determined by plugging the local value of temperature 
(<i>T</i>) into the following formula:

<dl>
<dd><img class="tex" alt="\mu = \mu_0 \left( \frac{T}{T_0} \right)^{3/2} \left(
\frac{T_0 + S}{T+S} \right)"
  src="sutherland_eqns/img2.png" /></dd>
</dl>

<p><span style="text-align: left; font-weight: 400; font-size: medium">where
<img class="tex" alt="\mu_0 = 1.716 \times 10^{-5} kg/(ms)" src="sutherland_eqns/img3.png" />,
<img class="tex" alt="T_0 = 491.6 R" src="sutherland_eqns/img4.png" />, and
<img class="tex" alt="S = 198.6 R" src="sutherland_eqns/img5.png" />.
The same formula can be found <a href="http://www.cfd-online.com/Wiki/Sutherland%27s_law" target="_blank">online</a>
(with temperature constants given in degrees K and some small conversion differences).
Note that in terms of the reference quantities <u>for this particular case</u>, Sutherland's Law can equivalently be written:

<dl>
<dd><img class="tex" alt="\left( \frac{\mu}{\mu_{ref}} \right) = \left( \frac{T}{T_{ref}} \right)^{3/2} \left(
\frac{T_{ref} + S}{T+S} \right)"
  src="sutherland_eqns/img6.png" /></dd>
</dl>

<p><span style="text-align: left; font-weight: 400; font-size: medium">where
<img class="tex" alt="\mu_{ref}" src="sutherland_eqns/img7.png" />
is the reference dynamic viscosity that corresponds to the freestream in this case, and
freestream <img class="tex" alt="T_{ref}" src="sutherland_eqns/img8.png" /> 
is 540R.  This latter form may be more convenient for nondimensional codes.
(Specific details regarding an implementation of Sutherland's Law in nondimensional codes can be found in
<a href="Papers/sutherland_notes_cfl3d_fun3d.pdf">handwritten notes describing Sutherland's Law in CFL3D and FUN3D</a>.)

<p><span style="text-align: left; font-weight: 400; font-size: medium">Note that FUN3D and USM3D both ran this
case with first order spatial accuracy on the turbulence advection term, whereas CFL3D used second order.

<p><span style="text-align: left; font-weight: 400; font-size: medium"><b>It is also important to note that
unlike most other test cases on the Turbulence Modeling Resource website, 
for this particular test case the structured and unstructured grids
were created independently of one another. Thus they are not related, other than the fact that the body
shape and exit plane are the same.
In particular, the outer boundary extents are different: for the structured grid, it is located
approximately 20 unit lengths from the body; whereas for the unstructured grid, it is located
approximately 10 unit lengths from the body. The grid differences may have some impact on the results.</b>

<!--<p><span style="text-align: left; font-weight: 400; font-size: medium"><span style="color: blue">NOTE: The results below
used the original
posted grids, which  were based on the scaled NACA 0012 airfoil shape with a small typo in one of the coefficients.  Through
testing, the typo has been found to make insignificant differences in the CFD results.  Even though results are
expected to be essentially the same, they will be updated to reflect the
corrected grids at some point in the future.</span></p>-->

<br>&nbsp;
<p><span style="text-align: left; font-weight: 700; font-size: large">Grid Convergence Behavior of Drag and Maximum Eddy Viscosity

<p><span style="text-align: left; font-weight: 400; font-size: medium">
Plots are shown to illustrate grid convergence for the drag coefficients and maximum eddy viscosity in the field
(the contributions to the drag coefficient due to the viscosity and pressure are presented separately).
Recall that all models were run using <a href="spalart.html#saneg">SA-neg</a>.
The codes appear to be consistent for the drag values, but do not appear to be approaching the same
level for maximum eddy viscosity.  The reason for this inconsistency is not known.  
These plots draw attention to the fact that the
structured grids (used by CFL3D) are considerably coarser than the unstructured grids (used by FUN3D and USM3D).

<p>For computing forces, the reference area of this case is taken to be 10 in<sup>2</sup> (for the full 360 degrees), or
5 in<sup>2</sup> (for a half-plane computation of 180 degrees).

     <table width="675" border="0">
     <center>
       <tr align="center" valign="bottom">

        <p><img
src="HCnumerics_val/SA/cd_alone_convergence.jpg" border="1" title="SA - drag coefficient vs h" 
alt="SA - drag coefficient vs h">
           <img
src="HCnumerics_val/SA/cdp_alone_convergence.jpg" border="1" title="SA - pressure drag coefficient vs h" 
alt="SA - pressure drag coefficient vs h">
        <p><img
src="HCnumerics_val/SA/cdv_alone_convergence.jpg" border="1" title="SA - viscous drag coefficient vs h" 
alt="SA - viscous drag coefficient vs h">
           <img
src="HCnumerics_val/SA/mut_alone_convergence.jpg" border="1" title="SA - max eddy viscosity vs h" 
alt="SA - max eddy viscosity vs h">
        </p>
           </td>

       </tr>
     </center>
     </table>

<p><span style="text-align: left; font-weight: 400; font-size: medium">
Results that generated the above plots can be found in the following data files:
<a href="HCnumerics_val/SA/fun3d_drag_mut_convergence_sa.dat">fun3d_drag_mut_convergence_sa.dat</a>,
<a href="HCnumerics_val/SA/usm3d_drag_mut_convergence_sa.dat">usm3d_drag_mut_convergence_sa.dat</a>,
<a href="HCnumerics_val/SA/cfl3d_drag_mut_convergence_sa.dat">cfl3d_drag_mut_convergence_sa.dat</a>.

<br>&nbsp;
<p><span style="text-align: left; font-weight: 700; font-size: large">Grid Convergence Behavior of Cp

<p><span style="text-align: left; font-weight: 400; font-size: medium">
The first plot below shows grid convergence of surface Cp at three x-locations on the body:  x=0.25, x=0.5,
and x=1.50.  When plotted at this scale, results look reasonably close between the three codes.
However, when zoomed in, there are differences at x=1.5 (see second plot below).  The reason
for this difference is believed to primarily be the fact that the structured grid (used by CFL3D) has a farfield
extent of approximately 20 unit lengths, whereas the unstructured grid (used by FUN3D and USM3D)
has a smaller farfield extent of 10 unit lengths.

     <table width="675" border="0">
     <center>
       <tr align="center" valign="bottom">

        <p><img
src="HCnumerics_val/SA/cp_convergence.jpg" border="1" title="SA - Cp vs h at 3 x-locations" 
alt="SA - Cp vs h at 3 x-locations">
           <img
src="HCnumerics_val/SA/cp_convergence_1.5only.jpg" border="1" title="SA - Cp vs h at x=1.5" 
alt="SA - Cp vs h at x=1.5">
        </p>
           </td>

       </tr>
     </center>
     </table>

<p><span style="text-align: left; font-weight: 400; font-size: medium">
Results that generated the above plots can be found in the following data files:
<a href="HCnumerics_val/SA/fun3d_cp_convergence_sa.dat">fun3d_cp_convergence_sa.dat</a>,
<a href="HCnumerics_val/SA/usm3d_cp_convergence_sa.dat">usm3d_cp_convergence_sa.dat</a>,
<a href="HCnumerics_val/SA/cfl3d_cp_convergence_sa.dat">cfl3d_cp_convergence_sa.dat</a>.

<p>To test the hypothesis that the farfield extent/shape has an influence on the
solution, some limited results were obtained with all 3 codes on the same grids.
The first plot below shows the FUN3D and USM3D Cp results on the default unstructured grids at
x=1.5 (these are the same results already shown above, with FF=10).  Then, the second plot shows
results for all 3 codes on the default structured grids (FF=20) used by CFL3D in the 
results shown above. Finally, a new set of structured grids was created with FF=10, and the 3 codes
produced the results shown in the third figure below.
Two conclusions can be made from this assessment: (1) the codes all approach the same results when run
on the same grid, and (2) the farfield boundary has an impact on the Cp at this location.
The pressure coefficient computed on the structured-grid domain with the 
farfield extent of 20 converges to a value about 2.5% lower (larger in magnitude)
than the pressure coefficient computed on the structured domain with the farfield extent of 10.
There is also apparently
a sensitivity to the shape of the farfield boundary when located in a relatively close proximity to the surface: the
pressure coefficients computed on domains with similar locations and different shapes of the farfield boundaries differ
by about 1.3% (compare the 2 results with FF=10).

     <table width="675" border="0">
     <center>
       <tr align="center" valign="bottom">

        <p><img
src="HCnumerics_val/SA/cp_convergence_1.5only_Uns10.jpg" border="1" title="SA - Cp vs h at x=1.5,
unstructured grid with FF=10" 
alt="SA - Cp vs h at x=1.5, unstructured grid with FF=10">
           <img
src="HCnumerics_val/SA/cp_convergence_1.5only_Str20.jpg" border="1" title="SA - Cp vs h at x=1.5,
structured grid with FF=20" 
alt="SA - Cp vs h at x=1.5, structured grid with FF=20">
        </p>
        <p><img
src="HCnumerics_val/SA/cp_convergence_1.5only_Str10.jpg" border="1" title="SA - Cp vs h at x=1.5,
structured grid with FF=10" 
alt="SA - Cp vs h at x=1.5, structured grid with FF=10">
        </p>
           </td>

       </tr>
     </center>
     </table>

<p><span style="text-align: left; font-weight: 400; font-size: medium">
Results that generated the above plots can be found in the following data files:
<a href="HCnumerics_val/SA/fun3d_cp_convergence_sa_str_grids.dat">fun3d_cp_convergence_sa_str_grids.dat</a>,
<a href="HCnumerics_val/SA/usm3d_cp_convergence_sa_str_grids.dat">usm3d_cp_convergence_sa_str_grids.dat</a>,
<a href="HCnumerics_val/SA/cfl3d_cp_convergence_sa_str_grids.dat">cfl3d_cp_convergence_sa_str_grids.dat</a>.

<br>&nbsp;
<p><span style="text-align: left; font-weight: 700; font-size: large">Cp and Cf Axially

<p><span style="text-align: left; font-weight: 400; font-size: medium">
The Cp and Cf distributions (axially, on the body) 
from the three codes on the finest grid are shown in the following figures.  All
results are very close to plotting accuracy.

     <table width="675" border="0">
     <center>
       <tr align="center" valign="bottom">

        <p><img
src="HCnumerics_val/SA/cp_axial_C+U+F.jpg" border="1" title="SA - Cp vs x" 
alt="SA - Cp vs x">
           <img
src="HCnumerics_val/SA/cf_axial_C+U+F.jpg" border="1" title="SA - Cf vs x" 
alt="SA - Cf vs x">
        </p>
           </td>

       </tr>
     </center>
     </table>

<p><span style="text-align: left; font-weight: 400; font-size: medium">
Results that generated the above Cp plots can be found in the following data files:
<a href="HCnumerics_val/SA/fun3d_cp_axial_sa.dat">fun3d_cp_axial_sa.dat</a>,
<a href="HCnumerics_val/SA/usm3d_cp_axial_sa.dat">usm3d_cp_axial_sa.dat</a>,
<a href="HCnumerics_val/SA/cfl3d_cp_axial_sa.dat">cfl3d_cp_axial_sa.dat</a>.
Results that generated the above Cf plots can be found in the following data files:
<a href="HCnumerics_val/SA/fun3d_cf_axial_sa.dat">fun3d_cf_axial_sa.dat</a>,
<a href="HCnumerics_val/SA/usm3d_cf_axial_sa.dat">usm3d_cf_axial_sa.dat</a>,
<a href="HCnumerics_val/SA/cfl3d_cf_axial_sa.dat">cfl3d_cf_axial_sa.dat</a>.

<br>&nbsp;
<p><span style="text-align: left; font-weight: 700; font-size: large">Cp, U-Velocity, and Eddy Viscosity Along a Spanwise Grid Line

<p><span style="text-align: left; font-weight: 400; font-size: medium">
The following plots show Cp and u-velocity along a radial line emanating from the surface at x=0.5:

     <table width="675" border="0">
     <center>
       <tr align="center" valign="bottom">

        <p><img
src="HCnumerics_val/SA/cp_radial_C+U+F.jpg" border="1" title="SA - Cp along radial line at x=0.5" 
alt="SA - Cp along radial line at x=0.5">
           <img
src="HCnumerics_val/SA/u_radial_C+U+F.jpg" border="1" title="SA - u/a_ref along radial line at x=0.5" 
alt="SA - u/a_ref along radial line at x=0.5">
        </p>
           </td>

       </tr>
     </center>
     </table>

<p><span style="text-align: left; font-weight: 400; font-size: medium">
Results that generated the above plots can be found in the following data files:
<a href="HCnumerics_val/SA/fun3d_various_radial_sa.dat">fun3d_various_radial_sa.dat</a>,
<a href="HCnumerics_val/SA/usm3d_various_radial_sa.dat">usm3d_various_radial_sa.dat</a>,
<a href="HCnumerics_val/SA/cfl3d_various_radial_sa.dat">cfl3d_various_radial_sa.dat</a>.

<p><span style="text-align: left; font-weight: 400; font-size: medium">
The following plot shows eddy viscosity along the same radial line emanating from the surface at x=0.5:

     <table width="675" border="0">
     <center>
       <tr align="center" valign="bottom">

        <p><img
src="HCnumerics_val/SA/mut_radial_C+U+F.jpg" border="1" title="SA - eddy viscosity along radial line at x=0.5" 
alt="SA - eddy viscosity along radial line at x=0.5">
        </p>
           </td>

       </tr>
     </center>
     </table>

<p><span style="text-align: left; font-weight: 400; font-size: medium">
Results that generated the above plots can be found in the following data files:
<a href="HCnumerics_val/SA/fun3d_mut_radial_sa.dat">fun3d_mut_radial_sa.dat</a>,
<a href="HCnumerics_val/SA/usm3d_mut_radial_sa.dat">usm3d_mut_radial_sa.dat</a>,
<a href="HCnumerics_val/SA/cfl3d_mut_radial_sa.dat">cfl3d_mut_radial_sa.dat</a>.

<br>&nbsp;
<p><span style="text-align: left; font-weight: 700; font-size: large">Radial Variations on the Surface

<p><span style="text-align: left; font-weight: 400; font-size: medium">
The following plots show radial variations of Cp and Cf at the location x=0.25, using 3 grid levels.
There is very little circumferential variation in the structured-grid CFL3D results, but on the unstructured grids
both FUN3D and USM3D show variations, particularly near the boundaries of 60-degree sectors, where
there are abrupt changes in the surface grid triangulation.

     <table width="675" border="0">
     <center>
       <tr align="center" valign="bottom">

        <p><img
src="HCnumerics_val/SA/cp_circumbody_x0.25_C+F.jpg" border="1" title="SA - Cp circumferentially at x=0.25, CFL3D vs. FUN3D, three grid levels" 
alt="SA - Cp circumferentially at x=0.25, CFL3D vs. FUN3D, three grid levels">
           <img
src="HCnumerics_val/SA/cp_circumbody_x0.25_C+U.jpg" border="1" title="SA - Cp circumferentially at x=0.25, CFL3D vs. USM3D, three grid levels" 
alt="SA - Cp circumferentially at x=0.25, CFL3D vs. USM3D, three grid levels">
        </p>

       </tr>
     </center>
     </table>

<p><span style="text-align: left; font-weight: 400; font-size: medium">
Results that generated the above plots can be found in the following data files:
<a href="HCnumerics_val/SA/fun3d_cp_circum_sa.dat">fun3d_cp_circum_sa.dat</a>,
<a href="HCnumerics_val/SA/usm3d_cp_circum_sa.dat">usm3d_cp_circum_sa.dat</a>,
<a href="HCnumerics_val/SA/cfl3d_cp_circum_sa.dat">cfl3d_cp_circum_sa.dat</a>.

     <table width="675" border="0">
     <center>
       <tr align="center" valign="bottom">

        <p><img
src="HCnumerics_val/SA/cf_circumbody_x0.25_C+F.jpg" border="1" title="SA - Cf circumferentially at x=0.25, CFL3D vs. FUN3D, three grid levels" 
alt="SA - Cf circumferentially at x=0.25, CFL3D vs. FUN3D, three grid levels">
           <img
src="HCnumerics_val/SA/cf_circumbody_x0.25_C+U.jpg" border="1" title="SA - Cf circumferentially at x=0.25, CFL3D vs. USM3D, three grid levels" 
alt="SA - Cf circumferentially at x=0.25, CFL3D vs. USM3D, three grid levels">
        </p> 

       </tr>
     </center>
     </table>

<p><span style="text-align: left; font-weight: 400; font-size: medium">
Results that generated the above plots can be found in the following data files:
<a href="HCnumerics_val/SA/fun3d_cf_circum_sa.dat">fun3d_cf_circum_sa.dat</a>,
<a href="HCnumerics_val/SA/usm3d_cf_circum_sa.dat">usm3d_cf_circum_sa.dat</a>,
<a href="HCnumerics_val/SA/cfl3d_cf_circum_sa.dat">cfl3d_cf_circum_sa.dat</a>.

<br>&nbsp;
<br>&nbsp;
<p><span style="text-align: left; font-weight: 400; font-size: medium">
<!--Jump to: <a href="flatplate_val_sst.html">SST Results</a>,&nbsp;
         <a href="flatplate_val_sstv.html">SST-V Results</a>,&nbsp;
         <a href="flatplate_val_w06.html">Wilcox2006 Results</a>,&nbsp;
         <a href="flatplate_val_easmkos.html">EASMko2003-S Results</a>,&nbsp;
         <a href="flatplate_val_kert.html">K-e-Rt Results</a>,&nbsp;
         <a href="flatplate_val_kkl-meah.html">K-kL-MEAH2013 Results</a></p>-->
<p>Return to: <a href="hc3dnumerics_val.html">3D Hemisphere Cylinder Validation for Numerical Analysis Intro Page</a></p>
<p>Return to: <a href="index.html">Turbulence Modeling Resource Home Page</a></p>
<br>&nbsp;

<br>&nbsp;
<p>
<hr WIDTH="100%">
<p style="font-family: helvetica,arial,sans-serif;"><a href="https://www.nasa.gov/about/highlights/HP_Privacy.html" target="_blank">Privacy Act Statement</a> </p>
<p style="font-family: helvetica,arial,sans-serif;"><a href="https://www.nasa.gov/accessibility" target="_blank">Accessibility Statement</a> </p>
<p align="right" style="font-family: helvetica,arial,sans-serif;"><strong>Responsible NASA Official:</strong>
  <a href="mailto:ethan.a.vogel@nasa.gov">Ethan Vogel</a> <br>
<strong>Page Curator:</strong>
  <a href="mailto:clark.c.pederson@nasa.gov">Clark Pederson</a> <br>
<strong>Last Updated:</strong> 11/05/2021
<br>&nbsp;

</body>
</html>
